<!--

    Licensed to Jasig under one or more contributor license
    agreements. See the NOTICE file distributed with this work
    for additional information regarding copyright ownership.
    Jasig licenses this file to you under the Apache License,
    Version 2.0 (the "License"); you may not use this file
    except in compliance with the License. You may obtain a
    copy of the License at:

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on
    an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, either express or implied. See the License for the
    specific language governing permissions and limitations
    under the License.

-->

<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context" xmlns:p="http://www.springframework.org/schema/p"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
      http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
      http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd">

    <context:component-scan base-package="org.jasig.portlet.proxy.mvc.portlet.gateway" />
    <context:annotation-config />

    <bean
            class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="location" value="classpath:configuration.properties" />
    </bean>
    <util:list id="gatewayEntries" scope="session">
        <!--
            Gateway SSO allows the user to sign onto remote systems through capture of credentials and
            replay of those credentials on remote systems.  Each bean in the contentRequest list is for a 
            different system.  The parameters property lists the fields that will be added to a form and then
            submitted to the proxiedLocation in order to authenticate.  The formFieldImpl class contains three
            fields: the field name and value, and whether the field is secured.  Secured is only relevant at this
            point for the portlet preferences interceptor, since those preferences must be stored in the database
            and are presented to the user in an HTML password input field, instead of an HTML text input field. 
         -->
        <!-- 
            <bean class="org.jasig.portlet.proxy.mvc.portlet.gateway.GatewayEntry" p:name="Zimbra"
                p:iconUrl="/ResourceServingWebapp/rs/tango/0.8.90/32x32/apps/internet-mail.png">
            <property name="contentRequests">
                <util:map>
                    <entry>
                        <key>
                            <bean class="org.jasig.portlet.proxy.service.web.HttpContentRequestImpl"
                                p:proxiedLocation="https://zimbra.unicon.net/zimbra/"
                                p:form="true" p:method="POST">
                                <property name="parameters">
                                    <util:map>
                                        <entry>
                                            <key><value>loginOp</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl">
                                                <property name="name" value="loginOp"/>
                                                <property name="value" value="login"/>
                                            </bean>
                                        </entry>
                                        <entry>
                                            <key><value>username</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl">
                                                <property name="name" value="username"/>
                                                <property name="value" value="{user.login.id}"/>
                                            </bean>
                                        </entry>
                                        <entry>
                                            <key><value>password</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl">
                                                <property name="name" value="password"/>
                                                <property name="value" value="{password}"/>
                                            </bean>
                                        </entry>
                                    </util:map>
                                </property>
                            </bean>
                        </key>
                        <util:list>
                            <value>userInfoUrlParameterizingPreInterceptor</value>
                        </util:list>
                    </entry>
                </util:map>
            </property>
        </bean>
        -->
        <!--
        The following bean shows two interceptors.  userInfoUrlParameterizingPreInterceptor
        will replace parameters with information from userInfo.  UserPreferencesPreInterceptor
        will replace parameters with information stored in portal preferences for the current user.
        Refer to those two classes for the format of values that will be substituted.
         -->
        <bean class="org.jasig.portlet.proxy.mvc.portlet.gateway.GatewayEntry" p:name="MyZimbra"
              p:iconUrl="/ResourceServingWebapp/rs/tango/0.8.90/32x32/apps/internet-mail.png">
            <property name="contentRequests">
                <util:map>
                    <entry>
                        <key>
                            <bean class="org.jasig.portlet.proxy.service.web.HttpContentRequestImpl"
                                  p:proxiedLocation="https://zimbra.unicon.net/zimbra/"
                                  p:form="true" p:method="POST">
                                <property name="parameters">
                                    <util:map>
                                        <entry>
                                            <key><value>loginOp</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                    p:name="loginOp" p:value="login"/>
                                        </entry>
                                        <entry>
                                            <key><value>username</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                    p:name="username" p:value="{prefs.myzimbra.uid}"/>
                                        </entry>
                                        <entry>
                                            <key><value>password</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                    p:name="password" p:value="{prefs.myzimbra.pwd}" p:secured="true"/>
                                        </entry>
                                    </util:map>
                                </property>
                            </bean>
                        </key>
                        <util:list>
                            <value>userInfoUrlParameterizingPreInterceptor</value>
                            <value>UserPreferencesPreInterceptor</value>
                        </util:list>
                    </entry>
                </util:map>
            </property>
        </bean>

        <!-- USD configuration -->
        <bean class="org.jasig.portlet.proxy.mvc.portlet.gateway.GatewayEntry" p:name="SNAP"
              p:iconUrl="/ResourceServingWebapp/rs/tango/0.8.90/32x32/apps/internet-web-browser.png">
            <property name="contentRequests">
                <util:map>
                    <entry>
                        <key>
                            <bean class="org.jasig.portlet.proxy.service.web.HttpContentRequestImpl"
                                  p:proxiedLocation="https://snap.sdbor.edu/cp/home/login"
                                  p:form="true" p:method="POST">
                                <property name="parameters">
                                    <util:map>
                                        <entry>
                                            <key><value>username</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                    p:name="user" p:value="{prefs.snap.username}"/>
                                        </entry>
                                        <entry>
                                            <key><value>password</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                    p:name="pass" p:value="{prefs.snap.password}" p:secured="true"/>
                                        </entry>
                                        <entry>
                                            <key><value>uuid</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                    p:name="uuid" p:value="9999999999999"/>
                                        </entry>
                                    </util:map>
                                </property>
                            </bean>
                        </key>
                        <util:list>
                            <value>UserPreferencesPreInterceptor</value>
                        </util:list>
                    </entry>
                </util:map>
            </property>
        </bean>
        <bean class="org.jasig.portlet.proxy.mvc.portlet.gateway.GatewayEntry" p:name="Desire2Learn"
              p:iconUrl="https://d2l.sdbor.edu/images/logo_d2l.gif">
            <property name="contentRequests">
                <util:map>
                    <entry>
                        <key>
                            <bean class="org.jasig.portlet.proxy.service.web.HttpContentRequestImpl"
                                  p:proxiedLocation="https://d2l.sdbor.edu/d2l/lp/auth/login/login.d2l"
                                  p:form="true" p:method="POST">
                                <property name="parameters">
                                    <util:map>
                                        <entry>
                                            <key><value>operation</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                    p:name="Login" p:value="Login"/>
                                        </entry>
                                        <entry>
                                            <key><value>username</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                    p:name="Username" p:value="{prefs.d2l.username}"/>
                                        </entry>
                                        <entry>
                                            <key><value>password</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                    p:name="Password" p:value="{prefs.d2l.password}" p:secured="true"/>
                                        </entry>
                                    </util:map>
                                </property>
                            </bean>
                        </key>
                        <util:list>
                            <value>UserPreferencesPreInterceptor</value>
                        </util:list>
                    </entry>
                </util:map>
            </property>
        </bean>
        <bean class="org.jasig.portlet.proxy.mvc.portlet.gateway.GatewayEntry" p:name="3n"
              p:iconUrl="/ResourceServingWebapp/rs/tango/0.8.90/32x32/apps/internet-web-browser.png">
            <property name="contentRequests">
                <util:map>
                    <entry>
                        <key>
                            <bean class="org.jasig.portlet.proxy.service.web.HttpContentRequestImpl"
                                  p:proxiedLocation="https://www.everbridge.net/nns/login.do"
                                  p:form="true" p:method="POST">
                                <property name="parameters">
                                    <util:map>
                                        <entry>
                                            <key><value>username</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                    p:name="j_username" p:value="{prefs.3n.username}"/>
                                        </entry>
                                        <entry>
                                            <key><value>password</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="j_password" p:value="{prefs.3n.password}" p:secured="true"/>
                                        </entry>
                                        <entry>
                                            <key><value>tz</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="tz" p:value="-300"/>
                                        </entry>
                                        <entry>
                                            <key><value>javaStatus</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="javaStatus" p:value=""/>
                                        </entry>
                                        <entry>
                                            <key><value>attemptCount</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="attemptCount" p:value="0"/>
                                        </entry>
                                        <entry>
                                            <key><value>maxCount</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="maxCount" p:value="0"/>
                                        </entry>
                                        <entry>
                                            <key><value>attemptId</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="attemptId" p:value=""/>
                                        </entry>
                                        <entry>
                                            <key><value>failedLoginId1</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="failedLoginId1" p:value=""/>
                                        </entry>
                                        <entry>
                                            <key><value>failedLoginId2</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="failedLoginId2" p:value=""/>
                                        </entry>
                                        <entry>
                                            <key><value>failedLoginId3</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="failedLoginId3" p:value=""/>
                                        </entry>
                                        <entry>
                                            <key><value>failedPassword1</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="failedPassword1" p:value=""/>
                                        </entry>
                                        <entry>
                                            <key><value>failedPassword2</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="failedPassword2" p:value=""/>
                                        </entry>
                                        <entry>
                                            <key><value>failedPassword3</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="failedPassword3" p:value=""/>
                                        </entry>
                                        <entry>
                                            <key><value>failedLoginType</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="failedLoginType" p:value=""/>
                                        </entry>
                                        <entry>
                                            <key><value>flashVersion</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="flashVersion" p:value=""/>
                                        </entry>
                                    </util:map>
                                </property>
                            </bean>
                        </key>
                        <util:list>
                            <value>UserPreferencesPreInterceptor</value>
                        </util:list>
                    </entry>
                </util:map>
            </property>
        </bean>
        <bean class="org.jasig.portlet.proxy.mvc.portlet.gateway.GatewayEntry" p:name="one45"
              p:iconUrl="/ResourceServingWebapp/rs/tango/0.8.90/32x32/apps/internet-web-browser.png">
            <property name="contentRequests">
                <util:map>
                    <entry>
                        <key>
                            <bean class="org.jasig.portlet.proxy.service.web.HttpContentRequestImpl"
                                  p:proxiedLocation="https://www.one45.com/webeval/usd/one.php"
                                  p:form="true" p:method="POST">
                                <property name="parameters">
                                    <util:map>
                                        <entry>
                                            <key><value>username</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="username" p:value="{prefs.one45.username}"/>
                                        </entry>
                                        <entry>
                                            <key><value>password</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="password" p:value="{prefs.one45.password}" p:secured="true"/>
                                        </entry>
                                        <entry>
                                            <key><value>screen_width</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="screen_width" p:value=""/>
                                        </entry>
                                        <entry>
                                            <key><value>screen_height</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="screen_height" p:value=""/>
                                        </entry>
                                        <entry>
                                            <key><value>available_screen_width</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="available_screen_width" p:value=""/>
                                        </entry>
                                        <entry>
                                            <key><value>available_screen_height</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="available_screen_height" p:value=""/>
                                        </entry>
                                        <entry>
                                            <key><value>browser_height</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="browser_height" p:value=""/>
                                        </entry>
                                        <entry>
                                            <key><value>browser_width</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="browser_width" p:value=""/>
                                        </entry>
                                        <entry>
                                            <key><value>location</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="location" p:value=""/>
                                        </entry>
                                        <entry>
                                            <key><value>manager</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="manager" p:value="loginManager"/>
                                        </entry>
                                        <entry>
                                            <key><value>purpose</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="purpose" p:value="login"/>
                                        </entry>
                                    </util:map>
                                </property>
                            </bean>
                        </key>
                        <util:list>
                            <value>UserPreferencesPreInterceptor</value>
                        </util:list>
                    </entry>
                </util:map>
            </property>
        </bean>
        <bean class="org.jasig.portlet.proxy.mvc.portlet.gateway.GatewayEntry" p:name="e-value"
              p:iconUrl="/ResourceServingWebapp/rs/tango/0.8.90/32x32/apps/internet-web-browser.png">
            <property name="contentRequests">
                <util:map>
                    <entry>
                        <key>
                            <bean class="org.jasig.portlet.proxy.service.web.HttpContentRequestImpl"
                                  p:proxiedLocation="https://www.e-value.net/index.cfm"
                                  p:form="true" p:method="POST">
                                <property name="parameters">
                                    <util:map>
                                        <entry>
                                            <key><value>username</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="username" p:value="{prefs.e-value.username}"/>
                                        </entry>
                                        <entry>
                                            <key><value>password</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="password" p:value="{prefs.e-value.password}" p:secured="true"/>
                                        </entry>
                                        <entry>
                                            <key><value>fuseaction</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="fuseaction" p:value="users_login"/>
                                        </entry>
                                        <entry>
                                            <key><value>InstitutionCode</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="InstitutionCode" p:value=""/>
                                        </entry>
                                    </util:map>
                                </property>
                            </bean>
                        </key>
                        <util:list>
                            <value>UserPreferencesPreInterceptor</value>
                        </util:list>
                    </entry>
                </util:map>
            </property>
        </bean>
        <bean class="org.jasig.portlet.proxy.mvc.portlet.gateway.GatewayEntry" p:name="CoyoteCareers"
              p:iconUrl="/ResourceServingWebapp/rs/tango/0.8.90/32x32/apps/internet-web-browser.png">
            <property name="contentRequests">
                <util:map>
                    <entry>
                        <key>
                            <bean class="org.jasig.portlet.proxy.service.web.HttpContentRequestImpl"
                                  p:proxiedLocation="https://www.myinterfase.com/usd/student/home.aspx"
                                  p:form="true" p:method="POST">
                                <property name="parameters">
                                    <util:map>
                                        <entry>
                                            <key><value>username</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="textUser" p:value="{prefs.coyotecareers.username}"/>
                                        </entry>
                                        <entry>
                                            <key><value>password</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="textPass" p:value="{prefs.coyotecareers.password}" p:secured="true"/>
                                        </entry>
                                        <entry>
                                            <key><value>scheme</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="scheme" p:value="http"/>
                                        </entry>
                                    </util:map>
                                </property>
                            </bean>
                        </key>
                        <util:list>
                            <value>UserPreferencesPreInterceptor</value>
                        </util:list>
                    </entry>
                </util:map>
            </property>
        </bean>
        <bean class="org.jasig.portlet.proxy.mvc.portlet.gateway.GatewayEntry" p:name="WestLaw"
              p:iconUrl="/ResourceServingWebapp/rs/tango/0.8.90/32x32/apps/internet-web-browser.png">
            <property name="contentRequests">
                <util:map>
                    <entry>
                        <key>
                            <bean class="org.jasig.portlet.proxy.service.web.HttpContentRequestImpl"
                                  p:proxiedLocation="https://lawschool.westlaw.com/shared/signon10.asp?path=%2FDesktopDefault%2Easpx"
                                  p:form="true" p:method="POST">
                                <property name="parameters">
                                    <util:map>
                                        <entry>
                                            <key><value>username</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="mupusername" p:value="{prefs.westlaw.username}"/>
                                        </entry>
                                        <entry>
                                            <key><value>password</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="muppassword" p:value="{prefs.westlaw.password}" p:secured="true"/>
                                        </entry>
                                        <entry>
                                            <key><value>originalsrc</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="originalsrc" p:value=""/>
                                        </entry>
                                        <entry>
                                            <key><value>src</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="src" p:value="my"/>
                                        </entry>
                                        <entry>
                                            <key><value>gosignon</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="gosignon" p:value="2"/>
                                        </entry>
                                        <entry>
                                            <key><value>signon</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="signon" p:value=""/>
                                        </entry>
                                    </util:map>
                                </property>
                            </bean>
                        </key>
                        <util:list>
                            <value>UserPreferencesPreInterceptor</value>
                        </util:list>
                    </entry>
                </util:map>
            </property>
        </bean>
        <bean class="org.jasig.portlet.proxy.mvc.portlet.gateway.GatewayEntry" p:name="WestLaw2"
              p:iconUrl="/ResourceServingWebapp/rs/tango/0.8.90/32x32/apps/internet-web-browser.png">
            <property name="contentRequests">
                <util:map>
                    <entry>
                        <key>
                            <bean class="org.jasig.portlet.proxy.service.web.HttpContentRequestImpl"
                                  p:proxiedLocation="https://lawschool.westlaw.com/shared/signon02.asp?path=%2FDesktopDefault%2Easpx"
                                  p:form="true" p:method="POST">
                                <property name="parameters">
                                    <util:map>
                                        <entry>
                                            <key><value>username</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="mupusername" p:value="{prefs.westlaw2.username}"/>
                                        </entry>
                                        <entry>
                                            <key><value>password</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="muppassword" p:value="{prefs.westlaw2.password}" p:secured="true"/>
                                        </entry>
                                        <entry>
                                            <key><value>originalsrc</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="originalsrc" p:value=""/>
                                        </entry>
                                        <entry>
                                            <key><value>src</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="src" p:value="my"/>
                                        </entry>
                                        <entry>
                                            <key><value>gosignon</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="gosignon" p:value="2"/>
                                        </entry>
                                        <entry>
                                            <key><value>signon</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="signon" p:value=""/>
                                        </entry>
                                    </util:map>
                                </property>
                            </bean>
                        </key>
                        <util:list>
                            <value>UserPreferencesPreInterceptor</value>
                        </util:list>
                    </entry>
                </util:map>
            </property>
        </bean>
        <bean class="org.jasig.portlet.proxy.mvc.portlet.gateway.GatewayEntry" p:name="WebAdvisor"
              p:iconUrl="/ResourceServingWebapp/rs/tango/0.8.90/32x32/apps/internet-web-browser.png">
            <property name="contentRequests">
                <util:map>
                    <entry>
                        <key>
                            <bean class="org.jasig.portlet.proxy.service.web.HttpContentRequestImpl"
                                  p:proxiedLocation="formCalculated"
                                  p:form="true" p:method="POST">
                                <property name="parameters">
                                    <util:map>
                                        <entry>
                                            <key><value>username</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="USER.NAME" p:value="{prefs.webadvisor.username}"/>
                                        </entry>
                                        <entry>
                                            <key><value>password</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="CURR.PWD" p:value="{prefs.webadvisor.password}" p:secured="true"/>
                                        </entry>
                                        <entry>
                                            <key><value>JS_ENABLED</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="JS_ENABLED" p:value="Y"/>
                                        </entry>
                                        <entry>
                                            <key><value>SUBMIT_OPTIONS</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="SUBMIT_OPTIONS" p:value=""/>
                                        </entry>
                                        <entry>
                                            <key><value>SUBMIT</value></key>
                                            <bean class="org.jasig.portlet.proxy.service.web.FormFieldImpl"
                                                  p:name="SUBMIT" p:value="SUBMIT"/>
                                        </entry>
                                    </util:map>
                                </property>
                                <property name="javascript">
                                    <value><![CDATA[
                                        //--hit WebAdvisor to retrieve a token
                                        String urlSource ="https://wa-usd.prod.sdbor.edu/WebAdvisor/webadvisor?&TYPE=M&PID=CORE-WBMAIN&TOKENIDX="; //must be secure
                                        URL xmlURLToOpen = new URL(urlSource);

                                        String headerInfo = xmlURLToOpen.openConnection().getHeaderFields().toString();
                                        int headerInfoBegin = headerInfo.indexOf("LASTTOKEN=");
                                        String tokenID = headerInfo.substring(headerInfoBegin+10,headerInfoBegin+20);
                                        tokenID = tokenID.replaceAll("=","");
                                        tokenID = tokenID.replaceAll(",","");
                                        String formAction = urlSource+tokenID+"&SS=LGRQ&URL=https%3A%2F%2Fwa-usd.prod.sdbor.edu%2FWebAdvisor%2Fwebadvisor%3F%26TYPE%3DM%26PID%3DCORE-WBMAIN%26TOKENIDX%3D"+tokenID;
                                        form.attr("action", formAction);
                                            ]]></value>
                                </property>
                            </bean>
                        </key>
                        <util:list>
                            <value>UserPreferencesPreInterceptor</value>
                        </util:list>
                    </entry>
                </util:map>
            </property>
        </bean>
    </util:list>
    <bean class="org.springframework.web.portlet.mvc.annotation.DefaultAnnotationHandlerMapping">
        <property name="interceptors"><bean class="org.jasig.portlet.proxy.mvc.MinimizedStateHandlerInterceptor"/></property>
    </bean>

</beans>
